<?xml version="1.0" encoding="windows-1252"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
    xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">

    <Product Name="Alacritty" Id="*" UpgradeCode="87c21c74-dbd5-4584-89d5-46d9cd0c40a7" Language="1033" Codepage="1252" Version="0.2.9" Manufacturer="Alacritty">
        <Package InstallerVersion="200" Compressed="yes" InstallScope="perUser"/>
        <MajorUpgrade AllowSameVersionUpgrades="yes" DowngradeErrorMessage="A newer version of [ProductName] is already installed."/>
        <Icon Id="AlacrittyIco" SourceFile="../assets/windows/alacritty.ico"/>
        <WixVariable Id="WixUILicenseRtf" Value="license.rtf"/>
        <Property Id="ARPPRODUCTICON" Value="AlacrittyIco"/>
        <MediaTemplate EmbedCab="yes"/>
        <UIRef Id="WixUI_Minimal"/>

        <Feature Id="ProductFeature" Title="ConsoleApp" Level="1">
            <ComponentRef Id="AlacrittyExe"/>
            <ComponentRef Id="WinPtyAgentExe"/>
            <ComponentRef Id="AlacrittyConfig"/>
            <ComponentRef Id="AlacrittyShortcut"/>
        </Feature>

        <!-- Create directories -->
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFiles64Folder">
                <Directory Id="AlacrittyProgramFiles" Name="Alacritty"/>
            </Directory>
            <Directory Id="AppDataFolder">
                <Directory Id="AlacrittyAppData" Name="alacritty"/>
            </Directory>
            <Directory Id="ProgramMenuFolder">
                <Directory Id="AlacrittyProgramMenu" Name="Alacritty"/>
            </Directory>
        </Directory>

        <DirectoryRef Id="AlacrittyProgramFiles">
            <!-- Application binaries -->
            <Component Id="AlacrittyExe" Guid="*">
                <File Id="AlacrittyExeFile" Source="../target/release/alacritty.exe" Name="alacritty.exe" KeyPath="yes"/>
            </Component>
            <Component Id="WinPtyAgentExe" Guid="*">
                <File Id="WinPtyAgentExeFile" Source="../target/release/winpty-agent.exe" Name="winpty-agent.exe" KeyPath="yes"/>
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="AlacrittyAppData">
            <!-- Copy default config -->
            <Component Id="AlacrittyConfig" Guid="*" Permanent="yes">
                <File Id="AlacrittyConfigFile" Source="../alacritty.yml" Name="alacritty.yml" KeyPath="yes"/>
            </Component>
        </DirectoryRef>

        <!-- Application shortcut -->
        <DirectoryRef Id="AlacrittyProgramMenu">
            <Component Id="AlacrittyShortcut" Guid="aa36e61a-23cd-4383-b744-2f78e912f0dc"> 
                <Shortcut Id="AlacrittyShortcutFile" Name="Alacritty" Description="A cross-platform, GPU-accelerated terminal emulator" Target="[AlacrittyProgramFiles]alacritty.exe"/>
                <RemoveFolder Id="AlacrittyProgramMenu" On="uninstall"/>
                <RegistryValue Root="HKCU" Key="Software\Microsoft\Alacritty" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
            </Component>
        </DirectoryRef>
    </Product>

</Wix>


